version: '2'
services:
    couchbase1:
        build: .
        image: vice-db
        environment:
         - CLUSTER=localhost
         - USER=admin
         - PASS=secret
         - PORT=8091
         - RAMSIZEMB=2048
         - RAMSIZEINDEXMB=512
         - RAMSIZEFTSMB=512
         - BUCKETS=vice-users vice-environments vice-images vice-deployments
         - BUCKETSIZES=512 512 512 512
    couchbase2:
        build: .
        image: vice-db
        environment:
         - CLUSTER=couchbase1:8091
         - USER=admin
         - PASS=secret
         - PORT=8091
         - RAMSIZEMB=2048
         - RAMSIZEINDEXMB=512
         - RAMSIZEFTSMB=512
         - AUTOREBALANCE=true
        depends_on:
          - couchbase1
    couchbase3:
        build: .
        image: vice-db